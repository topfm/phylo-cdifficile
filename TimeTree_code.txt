#Sequence assembly and Timetree creation of C. difficile isolates downloaded from He et al., 2013. 

#1. Assemble the fastq files. assemblies is directory with all fastqs.

mtopf@BaseByte:~/temp-mtopf/all_He_data/assemblies$ while read f; do ../../../../../home/myoungblom/scripts/scripts/RGAPepPipe.sh $f ../../../../../opt/data/cdiff/R20291.fasta; done < He_accessions.txt


With parallel: goes much faster

cat He_accessions.txt | parallel -I% ../../../../../home/myoungblom/scripts/scripts/RGAPepPipe.sh % ../../../../../opt/data/cdiff/R20291.fasta

rest_of_accessio#note: pilonVCFtoFasta does not work. this must be re-run after peppipe completes. 

~/temp-mtopf/all_He_data/He,etal_2013/RGAPepPipe_MAY/VCFtoFasta.py *.vcf 


#now we have fasta files

cat *.fasta > input.fasta

vim input.fasta
#remove the weird labels of the headers
:%s/_pilon//g
:%s/pilon_//g
:%s/RGA_to_FN545816.1//g
:%s/Clostridium difficile R20291 complete genome//g

#make a tree

/opt/PepPrograms/FastTree-2.1.9 -nt -gamma -slow -boot 100 input.fasta > tree.out

#use dendroscope to convert fasttree to newick format
ssh -X mtopf@basebyte
opt/PepPrograms/dendroscope/Dendroscope
open the folder, export as .newick

#make TimeTree
Here, I had to switch to working on my computer because timetree on the server wasnt working. 

timetree/bin/timetree —-tree —- dates —- alignment (cat fastas)
 
#head to R to visualize! save everything on computer.

